{% extends "page.html" %}
{% load i18n %}

{% block inner %}
<div class="col-xs-12" id="rows_append">
<h1>{% trans 'Search results' %}</h1>
<p>{% trans 'Your query was' %} <strong>{{ query }}</strong>. {% trans 'Do you want better results?' %} <a href="/search/advanced/">{% trans 'Try advanced search' %}.</a></p>

{% include page_template %}

</div> <!-- /.col-xs-12 -->
{% endblock %}

{% block script %}
    {{ block.super }}
    <script type="text/javascript">
    var settings = {
        containerSelector: '#scrolling_container',
        loadingSelector: '#scrolling_loading',
        scrolling_more: '#scrolling_more',
        rows_append: '#rows_append'
    };

    $(window).scroll(function() {
        if($(window).scrollTop() == $(document).height() - $(window).height()) {
            var loading = $(settings.loadingSelector);
            if (loading.is(':visible')) {
                return false;
            }
            loading.show();
            $.ajax({
                url: $(settings.scrolling_more).attr('href'),
                success: function(html) {
                    if(html) {
                        $(settings.containerSelector).remove();
                        $(settings.rows_append).append(html);
                    }
                }
            });
        }
    });

    </script>
{% endblock %}
